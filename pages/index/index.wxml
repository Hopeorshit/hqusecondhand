<import src="/templates/goods/goods.wxml" />
<import src="/templates/loading/loading.wxml" />
<view wx:if="{{!notFirstLoad}}" class='first-load'>
   <template is="first-load"></template>
</view>

<view wx:else>
  <view class="weui-search-bar" id='search'>
    <view class="weui-search-bar__form">
      <view class="weui-search-bar__box">
        <icon class="weui-icon-search_in-box" type="search" size="14"></icon>
        <input type="text" class="weui-search-bar__input" placeholder="搜索" value="{{inputVal}}" focus="{{inputShowed}}" bindinput="inputTyping" bindconfirm="search" />
        <view class="weui-icon-clear" wx:if="{{inputVal.length > 0}}" bindtap="clearInput">
          <icon type="clear" size="14"></icon>
        </view>
      </view>
      <label class="weui-search-bar__label" hidden="{{inputShowed}}" bindtap="showInput">
        <icon class="weui-icon-search" type="search" size="14"></icon>
        <view class="weui-search-bar__text">搜索</view>
      </label>
    </view>
  </view>

  <scroll-view class="scroll-view  {{scrollFixed?'scroll-fixed':''}}" scroll-x="true" bindscroll='tabScroll' id='tabs'>
    <view class="weui-navbar">
      <block wx:for="{{tabs}}" wx:key="index">
        <view id="{{index}}" class="weui-navbar__item {{activeIndex == index ? 'weui-bar__item_on' : ''}}" bindtap="tabClick">
          <view class="weui-navbar__title tab">{{item.item}}</view>
        </view>
      </block>
      <view class="weui-navbar__slider" style="transform: translateX({{sliderOffset}}px); -webkit-transform: translateX({{sliderOffset}}px); width:{{tabs[activeIndex].width}}px"></view>
    </view>
  </scroll-view>

  <view class="content">
    <view class="weui-tab__panel" class='scroll-y'>
      <block wx:for="{{tabs}}" wx:key="index">
        <view class="weui-tab__content" hidden="{{activeIndex != index}}">
          <view class='bannerbox' hidden='{{index!=0}}' >
            <swiper class="swiper" indicator-dots="true" autoplay="true" interval="5000" duration="1000" indicator-color='#dddddd' indicator-active-color='#ff6263'>
              <block wx:for="{{banner}}" wx:for-index="index" wx:key="key">
                <swiper-item>
                  <image src="{{item.url}}" class="slide-image" mode="aspectFill" bindtap='bannerTap' data-index="{{index}}"  />
                </swiper-item>
              </block>
            </swiper>
          </view>
          <template is="goods" data="{{list:tabs[index].list}}"></template>
           <template is="bottom-loading" data="{{hasMore:tabs[index].hasMore}}"/>  
        </view>
      </block>
    </view>
  </view>
</view>